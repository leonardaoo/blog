<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>ç¬”è®°</title>
    <!-- å¼•å…¥å¤–éƒ¨æ ·å¼ -->
    <link rel="stylesheet" href="/CSS/style.css">
    <link rel="stylesheet" href="/CSS/style_journal.css">
    <!-- å¼•å…¥vue -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/JS/main.js" defer></script>
</head>

<body id="app">
    <!-- è£…é¥°æ€§å…ƒç´  -->
    <div class="decoration decoration-1"></div>
    <div class="decoration decoration-2">
    </div>
    <header>
        <h1>ç¬”è®°</h1>
    </header>
    <!-- å˜æ¢ä¸»é¢˜ -->
    <div class="theme-toggle-container">
        <button @click="toggleTheme" class="theme-toggle-btn">
            <span class="theme-icon sun-icon">â˜€ï¸</span>
            <span class="theme-icon moon-icon">ğŸŒ™</span>
        </button>
    </div>
    <nav>
        <div class="nav-container">
            <a href="index.html">é¦–é¡µ</a>
            <a href="journal.html">æ—¥è®°</a>
            <a href="politics.html">æ”¿æ²»</a>
            <a href="growth.html">æˆé•¿</a>
            <a href="notes.html">ç¬”è®°</a>
        </div>
    </nav>

    <div class="journal-container">
        <div class="journal-header">
            <button @click="createNewArticle" class="new-article-btn">
                æ–°å»ºæ–‡ç« 
            </button>
        </div>

        <div v-if="articles.length === 0" class="empty-state">
            <h3>è¿˜æ²¡æœ‰æ–‡ç« </h3>
            <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹å†™ä½ çš„ç¬¬ä¸€ç¯‡æ–‡ç« å§ï¼</p>
        </div>

        <div v-for="article in articles" :key="article._id" class="article-card">
            <a :href="`/article.html?id=${article._id}`" class="article-title">
                {{ article.title }}
            </a>

            <div class="article-meta">
                <div class="article-info">
                    <span>{{ formatDate(article.createdAt) }}</span>
                    <span class="status-badge" :class="article.published ? 'status-published' : 'status-draft'">
                        {{ article.published ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿' }}
                    </span>
                </div>

                <div class="article-actions">
                    <button @click="editArticle(article._id)" class="action-btn edit-btn">
                        âœï¸ ç¼–è¾‘
                    </button>
                    <button v-if="!article.published" @click="publishArticle(article)" class="action-btn publish-btn">
                        ğŸ“¢ å‘å¸ƒ
                    </button>
                    <button v-if="article.published" @click="unpublishArticle(article)"
                        class="action-btn unpublish-btn">
                        ğŸ“ å–æ¶ˆå‘å¸ƒ
                    </button>
                    <button @click="deleteArticle(article)" class="action-btn delete-btn">
                        ğŸ—‘ï¸ åˆ é™¤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–ç‰¹å®šåŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function () {
            // ç­‰å¾… Vue åº”ç”¨æŒ‚è½½å®Œæˆ
            setTimeout(() => {
                if (window.vueApp) {
                    // è®¾ç½®å½“å‰é¡µé¢çš„åˆ†ç±»
                    window.vueApp.currentCategory = 'ç¬”è®°';
                    // è·å–æ–‡ç« åˆ—è¡¨
                    window.vueApp.fetchArticles();
                }
            }, 100);
        });
    </script>
</body>

</html>